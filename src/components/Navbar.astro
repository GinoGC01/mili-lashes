---
const navItems = [
  { name: 'Cursos', href: '#cursos' },
  { name: 'Mentora', href: '#mentora' },
  { name: 'Testimonios', href: '#testimonials' },
  { name: 'Contacto', href: '#contacto' },
];
---

<nav
  id="main-nav"
  class="fixed top-0 left-0 right-0 z-[100] transition-all duration-500 bg-[#121212]/60 backdrop-blur-md border-b border-white/5 h-20"
>
  <div class="max-w-7xl mx-auto px-6 h-full flex items-center justify-between">

    <!-- LOGO -->
    <a href="/" class="text-2xl md:text-3xl font-display font-black tracking-tight text-white">
      MILI <span class="chrome-text opacity-90">LASHES</span>
    </a>

    <!-- DESKTOP NAV -->
    <div class="hidden md:flex items-center gap-10">
      {navItems.map((item) => (
        <a
          href={item.href}
          class="relative text-xs uppercase tracking-[0.25em] text-slate-300 hover:text-white transition-colors duration-300 group"
        >
          {item.name}
          <span class="absolute left-0 -bottom-2 w-0 h-[2px] bg-primary transition-all duration-400 group-hover:w-full"></span>
        </a>
      ))}

      <a
        href="#contacto"
        class="ml-6 bg-primary/50 text-white px-6 py-2.5 rounded-full text-xs font-bold uppercase tracking-widest hover:scale-105 transition-transform duration-300 shadow-lg shadow-primary/20"
      >
        Reservar
      </a>
    </div>

    <!-- MOBILE BUTTON -->
    <button
      id="menu-toggle"
      class="md:hidden w-11 h-11 relative flex items-center justify-center"
      aria-label="Abrir menú"
      aria-expanded="false"
    >
      <span class="menu-line line-top"></span>
      <span class="menu-line line-bottom"></span>
    </button>
  </div>
</nav>

<!-- MOBILE MENU -->
<div
  id="mobile-menu"
  class="fixed inset-0 bg-black/60 backdrop-blur-xl z-[90] flex flex-col items-center justify-center gap-12 transform translate-y-full transition-transform duration-500 md:hidden"
>
  {navItems.map((item) => (
    <a
      href={item.href}
      class="mobile-link text-4xl font-display font-bold uppercase tracking-tight text-white hover:text-primary transition-colors duration-300"
    >
      {item.name}
    </a>
  ))}

  <a
    href="#contacto"
    class="mt-6 bg-primary/50 text-white px-10 py-4 rounded-full font-bold uppercase tracking-widest text-sm shadow-lg shadow-primary/30 "
  >
    Reservar Cupo
  </a>

  <!-- LOGO INFERIOR -->
  <div class="absolute bottom-10 opacity-25">
    <span class="font-display text-xl tracking-[0.4em] text-white">
      MILI LASHES
    </span>
  </div>
</div>

<script>
  function initNavbar() {
    const nav = document.getElementById('main-nav') as HTMLDivElement;
    const toggle = document.getElementById('menu-toggle') as HTMLDivElement;
    const mobileMenu = document.getElementById('mobile-menu') as HTMLDivElement;
    const mobileLinks = document.querySelectorAll('.mobile-link');

    if (!toggle || !mobileMenu) return;

    let isOpen = false;

    // Scroll effect
    window.addEventListener('scroll', () => {
      if (window.scrollY > 30) {
        nav?.classList.add('bg-[#121212]', 'shadow-lg');
      } else if (!isOpen) {
        nav?.classList.remove('bg-[#121212]', 'shadow-lg');
      }
    });

    function toggleMenu() {
      isOpen = !isOpen;
      toggle.setAttribute('aria-expanded', String(isOpen));

      mobileMenu.classList.toggle('translate-y-0');
      mobileMenu.classList.toggle('translate-y-full');

      toggle.classList.toggle('active');

      document.body.style.overflow = isOpen ? 'hidden' : '';
    }

    toggle.addEventListener('click', toggleMenu);

    mobileLinks.forEach(link => {
      link.addEventListener('click', () => {
        if (isOpen) toggleMenu();
      });
    });
  }

  document.addEventListener('DOMContentLoaded', initNavbar);
  document.addEventListener('astro:page-load', initNavbar);
</script>

<style>
  #menu-toggle {
    position: relative;
  }

  .menu-line {
    position: absolute;
    width: 24px;
    height: 2px;
    background: white;
    transition: all 0.4s ease;
    transform-origin: center;
  }

  .line-top {
    transform: translateY(-6px);
  }

  .line-bottom {
    transform: translateY(6px);
  }

  /* Estado activo → convierte en X */
  #menu-toggle.active .line-top {
    transform: rotate(45deg);
  }

  #menu-toggle.active .line-bottom {
    transform: rotate(-45deg);
  }
</style>
